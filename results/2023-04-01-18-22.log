2023-04-01 18:22:30,871 =======================================================
2023-04-01 18:22:30,871 Namespace(model_path='model_weights/', vocab_path='IUdata/IUdata_vocab_0threshold.pkl', image_dir='IUdata/NLMCXR_Frontal', json_dir='IUdata/IUdata_train.json', log_path='./results', resize_size=256, crop_size=224, batch_size=32, num_workers=0, embed_size=512, hidden_size=512, num_global_features=2048, imp_layers_num=1, fin_num_layers=2, sen_enco_num_layers=3, num_local_features=2048, num_regions=49, num_conv1d_out=1024, teach_rate=1.0, learning_rate=0.0001, epochs=50, sche_step_size=5, sche_decay=0.9, log_step=50, save_step=10, lambda_imp=0.5, lambda_fin=0.5, fix_image_encoder=True, dropout_rate=0.2, log_metrics_step=1, train_separately=True, imp_fin_only=True, eval_json_dir='IUdata/IUdata_test.json', eval_batch_size=75, max_impression_len=15, max_single_sen_len=15, max_sen_num=7, single_punc=True)
2023-04-01 18:22:30,871 =======================================================
2023-04-01 18:22:30,871 Start the 1th run of the same model
2023-04-01 18:22:37,758 Epoch: 1/50	Step: [0/91]	Imp Loss: 7.6106	Imp Perplexity: 2019.4336	Fin Loss: 7.6035	Imp Perplexity: 2005.1223 
2023-04-01 18:23:17,252 Epoch: 1/50	Step: [50/91]	Imp Loss: 3.8789	Imp Perplexity: 48.3686	Fin Loss: 4.3441	Imp Perplexity: 77.0260 
2023-04-01 18:24:13,626 The model performance improved when epoch [1/50], BLEU4:0.0452
2023-04-01 18:24:14,966 Epoch: 2/50	Step: [0/91]	Imp Loss: 3.6108	Imp Perplexity: 36.9940	Fin Loss: 3.9326	Imp Perplexity: 51.0410 
2023-04-01 18:24:55,969 Epoch: 2/50	Step: [50/91]	Imp Loss: 3.1864	Imp Perplexity: 24.2006	Fin Loss: 4.0048	Imp Perplexity: 54.8634 
2023-04-01 18:25:49,157 The model performance improved when epoch [2/50], BLEU4:0.0996
2023-04-01 18:25:50,441 Epoch: 3/50	Step: [0/91]	Imp Loss: 2.7834	Imp Perplexity: 16.1747	Fin Loss: 3.4759	Imp Perplexity: 32.3253 
2023-04-01 18:26:32,244 Epoch: 3/50	Step: [50/91]	Imp Loss: 3.9474	Imp Perplexity: 51.7982	Fin Loss: 3.7946	Imp Perplexity: 44.4607 
2023-04-01 18:27:26,702 Epoch: 4/50	Step: [0/91]	Imp Loss: 3.3411	Imp Perplexity: 28.2496	Fin Loss: 3.4306	Imp Perplexity: 30.8959 
2023-04-01 18:28:08,722 Epoch: 4/50	Step: [50/91]	Imp Loss: 3.0745	Imp Perplexity: 21.6384	Fin Loss: 3.0701	Imp Perplexity: 21.5446 
2023-04-01 18:29:02,151 Epoch: 5/50	Step: [0/91]	Imp Loss: 3.0509	Imp Perplexity: 21.1338	Fin Loss: 3.2000	Imp Perplexity: 24.5320 
