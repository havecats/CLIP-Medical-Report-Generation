2023-04-01 18:11:17,619 =======================================================
2023-04-01 18:11:17,619 Namespace(model_path='model_weights/', vocab_path='IUdata/IUdata_vocab_0threshold.pkl', image_dir='IUdata/NLMCXR_Frontal', json_dir='IUdata/IUdata_train.json', log_path='./results', resize_size=256, crop_size=224, batch_size=32, num_workers=0, embed_size=512, hidden_size=512, num_global_features=2048, imp_layers_num=1, fin_num_layers=2, sen_enco_num_layers=3, num_local_features=2048, num_regions=49, num_conv1d_out=1024, teach_rate=1.0, learning_rate=0.0001, epochs=50, sche_step_size=5, sche_decay=0.9, log_step=50, save_step=10, lambda_imp=0.5, lambda_fin=0.5, fix_image_encoder=True, dropout_rate=0.2, log_metrics_step=1, train_separately=True, imp_fin_only=True, eval_json_dir='IUdata/IUdata_test.json', eval_batch_size=75, max_impression_len=15, max_single_sen_len=15, max_sen_num=7, single_punc=True)
2023-04-01 18:11:17,619 =======================================================
2023-04-01 18:11:17,619 Namespace(model_path='model_weights/', vocab_path='IUdata/IUdata_vocab_0threshold.pkl', image_dir='IUdata/NLMCXR_Frontal', json_dir='IUdata/IUdata_train.json', log_path='./results', resize_size=256, crop_size=224, batch_size=32, num_workers=0, embed_size=512, hidden_size=512, num_global_features=2048, imp_layers_num=1, fin_num_layers=2, sen_enco_num_layers=3, num_local_features=2048, num_regions=49, num_conv1d_out=1024, teach_rate=1.0, learning_rate=0.0001, epochs=50, sche_step_size=5, sche_decay=0.9, log_step=50, save_step=10, lambda_imp=0.5, lambda_fin=0.5, fix_image_encoder=True, dropout_rate=0.2, log_metrics_step=1, train_separately=True, imp_fin_only=True, eval_json_dir='IUdata/IUdata_test.json', eval_batch_size=75, max_impression_len=15, max_single_sen_len=15, max_sen_num=7, single_punc=True)
2023-04-01 18:11:17,619 Start the 1th run of the same model
2023-04-01 18:11:28,102 	Epoch: 1/50	Step: [0/91]	Imp Loss: 7.6086	Imp Perplexity: 2015.4365	Fin Loss: 7.5941	Imp Perplexity: 2015.4365 
2023-04-01 18:12:08,684 	Epoch: 1/50	Step: [50/91]	Imp Loss: 4.2014	Imp Perplexity: 66.7779	Fin Loss: 4.4149	Imp Perplexity: 66.7779 
2023-04-01 18:13:00,657 The model performance improved when epoch [1/50], BLEU4:0.0366
2023-04-01 18:13:01,900 	Epoch: 2/50	Step: [0/91]	Imp Loss: 3.4354	Imp Perplexity: 31.0435	Fin Loss: 4.1093	Imp Perplexity: 31.0435 
2023-04-01 18:13:45,428 	Epoch: 2/50	Step: [50/91]	Imp Loss: 3.2859	Imp Perplexity: 26.7339	Fin Loss: 3.8733	Imp Perplexity: 26.7339 
2023-04-01 18:14:37,318 The model performance improved when epoch [2/50], BLEU4:0.0685
2023-04-01 18:14:38,587 	Epoch: 3/50	Step: [0/91]	Imp Loss: 2.8009	Imp Perplexity: 16.4603	Fin Loss: 3.6937	Imp Perplexity: 16.4603 
