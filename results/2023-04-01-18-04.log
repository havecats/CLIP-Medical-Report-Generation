2023-04-01 18:04:15,639 =======================================================
2023-04-01 18:04:15,639 Namespace(model_path='model_weights/', vocab_path='IUdata/IUdata_vocab_0threshold.pkl', image_dir='IUdata/NLMCXR_Frontal', json_dir='IUdata/IUdata_train.json', log_path='./results', resize_size=256, crop_size=224, batch_size=32, num_workers=0, embed_size=512, hidden_size=512, num_global_features=2048, imp_layers_num=1, fin_num_layers=2, sen_enco_num_layers=3, num_local_features=2048, num_regions=49, num_conv1d_out=1024, teach_rate=1.0, learning_rate=0.0001, epochs=50, sche_step_size=5, sche_decay=0.9, log_step=50, save_step=10, lambda_imp=0.5, lambda_fin=0.5, fix_image_encoder=True, dropout_rate=0.2, log_metrics_step=1, train_separately=True, imp_fin_only=True, eval_json_dir='IUdata/IUdata_test.json', eval_batch_size=75, max_impression_len=15, max_single_sen_len=15, max_sen_num=7, single_punc=True)
2023-04-01 18:04:15,640 =======================================================
2023-04-01 18:04:15,640 =======================================================
2023-04-01 18:04:15,640 Namespace(model_path='model_weights/', vocab_path='IUdata/IUdata_vocab_0threshold.pkl', image_dir='IUdata/NLMCXR_Frontal', json_dir='IUdata/IUdata_train.json', log_path='./results', resize_size=256, crop_size=224, batch_size=32, num_workers=0, embed_size=512, hidden_size=512, num_global_features=2048, imp_layers_num=1, fin_num_layers=2, sen_enco_num_layers=3, num_local_features=2048, num_regions=49, num_conv1d_out=1024, teach_rate=1.0, learning_rate=0.0001, epochs=50, sche_step_size=5, sche_decay=0.9, log_step=50, save_step=10, lambda_imp=0.5, lambda_fin=0.5, fix_image_encoder=True, dropout_rate=0.2, log_metrics_step=1, train_separately=True, imp_fin_only=True, eval_json_dir='IUdata/IUdata_test.json', eval_batch_size=75, max_impression_len=15, max_single_sen_len=15, max_sen_num=7, single_punc=True)
2023-04-01 18:04:15,640 =======================================================
2023-04-01 18:04:15,640 Start the 1th run of the same model
2023-04-01 18:04:28,795 	Epoch: 1/50	Step: [0/91]	Imp Loss: 7.5893	Imp Perplexity: 1976.9785	Fin Loss: 7.5815	Imp Perplexity: 1976.9785 
2023-04-01 18:05:08,437 	Epoch: 1/50	Step: [50/91]	Imp Loss: 4.3969	Imp Perplexity: 81.2011	Fin Loss: 4.5198	Imp Perplexity: 81.2011 
2023-04-01 18:06:01,381 The model performance improved when epoch [1/50], BLEU4:0.0342
2023-04-01 18:06:02,665 	Epoch: 2/50	Step: [0/91]	Imp Loss: 3.5895	Imp Perplexity: 36.2154	Fin Loss: 4.2384	Imp Perplexity: 36.2154 
2023-04-01 18:06:43,213 	Epoch: 2/50	Step: [50/91]	Imp Loss: 3.1608	Imp Perplexity: 23.5902	Fin Loss: 3.6901	Imp Perplexity: 23.5902 
2023-04-01 18:07:37,278 The model performance improved when epoch [2/50], BLEU4:0.084
2023-04-01 18:07:38,540 	Epoch: 3/50	Step: [0/91]	Imp Loss: 3.0502	Imp Perplexity: 21.1193	Fin Loss: 3.6229	Imp Perplexity: 21.1193 
2023-04-01 18:08:19,857 	Epoch: 3/50	Step: [50/91]	Imp Loss: 3.1689	Imp Perplexity: 23.7822	Fin Loss: 3.6617	Imp Perplexity: 23.7822 
2023-04-01 18:09:15,827 	Epoch: 4/50	Step: [0/91]	Imp Loss: 3.1145	Imp Perplexity: 22.5232	Fin Loss: 3.2016	Imp Perplexity: 22.5232 
