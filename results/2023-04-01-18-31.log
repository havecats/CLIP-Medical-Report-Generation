2023-04-01 18:31:06,547 =======================================================
2023-04-01 18:31:06,547 Namespace(model_path='model_weights/', vocab_path='IUdata/IUdata_vocab_0threshold.pkl', image_dir='IUdata/NLMCXR_Frontal', json_dir='IUdata/IUdata_train.json', log_path='./results', resize_size=256, crop_size=224, batch_size=32, num_workers=0, embed_size=512, hidden_size=512, num_global_features=2048, imp_layers_num=1, fin_num_layers=2, sen_enco_num_layers=3, num_local_features=2048, num_regions=49, num_conv1d_out=1024, teach_rate=1.0, learning_rate=0.0001, epochs=50, sche_step_size=5, sche_decay=0.9, log_step=50, save_step=10, lambda_imp=0.5, lambda_fin=0.5, fix_image_encoder=True, dropout_rate=0.2, log_metrics_step=1, train_separately=True, imp_fin_only=True, eval_json_dir='IUdata/IUdata_test.json', eval_batch_size=75, max_impression_len=15, max_single_sen_len=15, max_sen_num=7, single_punc=True)
2023-04-01 18:31:06,547 =======================================================
2023-04-01 18:31:06,548 Start the 1th run of the same model
2023-04-01 18:31:13,098 Epoch: 1/50	Step: [0/91]	Imp Loss: 7.6190	Imp Perplexity: 2036.5371	Fin Loss: 7.5946	Imp Perplexity: 1987.5270 
2023-04-01 18:31:52,766 Epoch: 1/50	Step: [50/91]	Imp Loss: 3.9444	Imp Perplexity: 51.6465	Fin Loss: 4.4060	Imp Perplexity: 81.9445 
2023-04-01 18:32:43,951 The model performance improved when epoch [1/50], BLEU4:0.0134
2023-04-01 18:32:45,179 Epoch: 2/50	Step: [0/91]	Imp Loss: 3.1285	Imp Perplexity: 22.8408	Fin Loss: 4.1284	Imp Perplexity: 62.0811 
2023-04-01 18:33:25,419 Epoch: 2/50	Step: [50/91]	Imp Loss: 3.4073	Imp Perplexity: 30.1848	Fin Loss: 3.9233	Imp Perplexity: 50.5695 
2023-04-01 18:34:16,007 The model performance improved when epoch [2/50], BLEU4:0.076
2023-04-01 18:34:17,233 Epoch: 3/50	Step: [0/91]	Imp Loss: 3.5751	Imp Perplexity: 35.6983	Fin Loss: 3.9266	Imp Perplexity: 50.7361 
2023-04-01 18:34:57,809 Epoch: 3/50	Step: [50/91]	Imp Loss: 3.3256	Imp Perplexity: 27.8156	Fin Loss: 3.5839	Imp Perplexity: 36.0122 
2023-04-01 18:35:50,346 The model performance improved when epoch [3/50], BLEU4:0.09
2023-04-01 18:35:51,541 Epoch: 4/50	Step: [0/91]	Imp Loss: 3.1743	Imp Perplexity: 23.9093	Fin Loss: 3.4633	Imp Perplexity: 31.9232 
2023-04-01 18:36:32,484 Epoch: 4/50	Step: [50/91]	Imp Loss: 3.2381	Imp Perplexity: 25.4848	Fin Loss: 3.5006	Imp Perplexity: 33.1358 
2023-04-01 18:37:25,594 Epoch: 5/50	Step: [0/91]	Imp Loss: 3.2194	Imp Perplexity: 25.0121	Fin Loss: 3.3483	Imp Perplexity: 28.4532 
2023-04-01 18:38:07,068 Epoch: 5/50	Step: [50/91]	Imp Loss: 2.8568	Imp Perplexity: 17.4054	Fin Loss: 3.0546	Imp Perplexity: 21.2119 
2023-04-01 18:39:03,915 The model performance improved when epoch [5/50], BLEU4:0.1045
2023-04-01 18:39:05,232 Epoch: 6/50	Step: [0/91]	Imp Loss: 2.9724	Imp Perplexity: 19.5380	Fin Loss: 2.9963	Imp Perplexity: 20.0123 
2023-04-01 18:39:45,478 Epoch: 6/50	Step: [50/91]	Imp Loss: 2.4433	Imp Perplexity: 11.5108	Fin Loss: 2.7966	Imp Perplexity: 16.3894 
2023-04-01 18:40:37,242 Epoch: 7/50	Step: [0/91]	Imp Loss: 2.2110	Imp Perplexity: 9.1248	Fin Loss: 2.5914	Imp Perplexity: 13.3486 
2023-04-01 18:41:17,312 Epoch: 7/50	Step: [50/91]	Imp Loss: 3.1426	Imp Perplexity: 23.1651	Fin Loss: 2.8527	Imp Perplexity: 17.3338 
2023-04-01 18:42:09,270 Epoch: 8/50	Step: [0/91]	Imp Loss: 2.8255	Imp Perplexity: 16.8689	Fin Loss: 2.9793	Imp Perplexity: 19.6745 
2023-04-01 18:42:49,942 Epoch: 8/50	Step: [50/91]	Imp Loss: 2.5481	Imp Perplexity: 12.7824	Fin Loss: 2.7164	Imp Perplexity: 15.1252 
2023-04-01 18:43:40,864 The model performance improved when epoch [8/50], BLEU4:0.1199
2023-04-01 18:43:42,113 Epoch: 9/50	Step: [0/91]	Imp Loss: 2.1073	Imp Perplexity: 8.2260	Fin Loss: 2.4351	Imp Perplexity: 11.4175 
2023-04-01 18:44:24,061 Epoch: 9/50	Step: [50/91]	Imp Loss: 2.3792	Imp Perplexity: 10.7958	Fin Loss: 2.7339	Imp Perplexity: 15.3924 
2023-04-01 18:45:14,637 The model performance improved when epoch [9/50], BLEU4:0.1221
2023-04-01 18:45:15,925 Epoch: 10/50	Step: [0/91]	Imp Loss: 2.4556	Imp Perplexity: 11.6537	Fin Loss: 2.5634	Imp Perplexity: 12.9804 
2023-04-01 18:45:56,426 Epoch: 10/50	Step: [50/91]	Imp Loss: 2.4272	Imp Perplexity: 11.3269	Fin Loss: 2.3724	Imp Perplexity: 10.7229 
2023-04-01 18:46:47,074 The model performance improved when epoch [10/50], BLEU4:0.1513
2023-04-01 18:46:48,352 Epoch: 11/50	Step: [0/91]	Imp Loss: 2.8502	Imp Perplexity: 17.2921	Fin Loss: 2.6828	Imp Perplexity: 14.6253 
2023-04-01 18:47:28,653 Epoch: 11/50	Step: [50/91]	Imp Loss: 2.8146	Imp Perplexity: 16.6859	Fin Loss: 2.6604	Imp Perplexity: 14.3022 
2023-04-01 18:48:19,132 The model performance improved when epoch [11/50], BLEU4:0.1533
2023-04-01 18:48:20,371 Epoch: 12/50	Step: [0/91]	Imp Loss: 2.7446	Imp Perplexity: 15.5577	Fin Loss: 2.6230	Imp Perplexity: 13.7770 
2023-04-01 18:49:00,706 Epoch: 12/50	Step: [50/91]	Imp Loss: 2.7761	Imp Perplexity: 16.0555	Fin Loss: 2.5344	Imp Perplexity: 12.6085 
2023-04-01 18:49:51,991 Epoch: 13/50	Step: [0/91]	Imp Loss: 2.6132	Imp Perplexity: 13.6424	Fin Loss: 2.5873	Imp Perplexity: 13.2944 
2023-04-01 18:50:32,189 Epoch: 13/50	Step: [50/91]	Imp Loss: 2.5759	Imp Perplexity: 13.1427	Fin Loss: 2.2748	Imp Perplexity: 9.7262 
2023-04-01 18:51:23,425 Epoch: 14/50	Step: [0/91]	Imp Loss: 2.7920	Imp Perplexity: 16.3142	Fin Loss: 2.4912	Imp Perplexity: 12.0758 
2023-04-01 18:52:03,567 Epoch: 14/50	Step: [50/91]	Imp Loss: 2.6721	Imp Perplexity: 14.4707	Fin Loss: 2.5206	Imp Perplexity: 12.4356 
2023-04-01 18:52:55,247 Epoch: 15/50	Step: [0/91]	Imp Loss: 2.5826	Imp Perplexity: 13.2320	Fin Loss: 2.5540	Imp Perplexity: 12.8587 
2023-04-01 18:53:35,391 Epoch: 15/50	Step: [50/91]	Imp Loss: 2.3418	Imp Perplexity: 10.4004	Fin Loss: 2.3664	Imp Perplexity: 10.6588 
2023-04-01 18:54:29,927 Epoch: 16/50	Step: [0/91]	Imp Loss: 2.5091	Imp Perplexity: 12.2939	Fin Loss: 2.5431	Imp Perplexity: 12.7191 
2023-04-01 18:55:10,352 Epoch: 16/50	Step: [50/91]	Imp Loss: 2.4613	Imp Perplexity: 11.7204	Fin Loss: 2.3519	Imp Perplexity: 10.5054 
2023-04-01 18:56:01,975 Epoch: 17/50	Step: [0/91]	Imp Loss: 2.5442	Imp Perplexity: 12.7326	Fin Loss: 2.1646	Imp Perplexity: 8.7115 
2023-04-01 18:56:42,506 Epoch: 17/50	Step: [50/91]	Imp Loss: 2.5422	Imp Perplexity: 12.7075	Fin Loss: 2.2700	Imp Perplexity: 9.6796 
2023-04-01 18:57:33,615 Epoch: 18/50	Step: [0/91]	Imp Loss: 2.4354	Imp Perplexity: 11.4199	Fin Loss: 2.3328	Imp Perplexity: 10.3065 
2023-04-01 18:58:13,771 Epoch: 18/50	Step: [50/91]	Imp Loss: 2.7661	Imp Perplexity: 15.8958	Fin Loss: 2.3326	Imp Perplexity: 10.3046 
2023-04-01 18:59:05,654 Epoch: 19/50	Step: [0/91]	Imp Loss: 2.9016	Imp Perplexity: 18.2032	Fin Loss: 2.5280	Imp Perplexity: 12.5286 
2023-04-01 18:59:46,005 Epoch: 19/50	Step: [50/91]	Imp Loss: 2.4910	Imp Perplexity: 12.0735	Fin Loss: 2.3960	Imp Perplexity: 10.9791 
2023-04-01 19:00:37,885 Epoch: 20/50	Step: [0/91]	Imp Loss: 2.2904	Imp Perplexity: 9.8789	Fin Loss: 2.0348	Imp Perplexity: 7.6504 
2023-04-01 19:01:18,195 Epoch: 20/50	Step: [50/91]	Imp Loss: 2.5001	Imp Perplexity: 12.1835	Fin Loss: 2.2390	Imp Perplexity: 9.3841 
2023-04-01 19:02:10,313 Epoch: 21/50	Step: [0/91]	Imp Loss: 2.3525	Imp Perplexity: 10.5122	Fin Loss: 2.0193	Imp Perplexity: 7.5332 
2023-04-01 19:02:50,674 Epoch: 21/50	Step: [50/91]	Imp Loss: 2.3057	Imp Perplexity: 10.0309	Fin Loss: 2.0988	Imp Perplexity: 8.1563 
2023-04-01 19:03:41,948 Epoch: 22/50	Step: [0/91]	Imp Loss: 2.5785	Imp Perplexity: 13.1772	Fin Loss: 2.1794	Imp Perplexity: 8.8409 
2023-04-01 19:04:22,230 Epoch: 22/50	Step: [50/91]	Imp Loss: 2.4552	Imp Perplexity: 11.6484	Fin Loss: 2.1301	Imp Perplexity: 8.4157 
2023-04-01 19:05:13,580 Epoch: 23/50	Step: [0/91]	Imp Loss: 2.5484	Imp Perplexity: 12.7869	Fin Loss: 2.2516	Imp Perplexity: 9.5026 
2023-04-01 19:05:53,627 Epoch: 23/50	Step: [50/91]	Imp Loss: 2.4724	Imp Perplexity: 11.8505	Fin Loss: 2.0919	Imp Perplexity: 8.1001 
2023-04-01 19:06:44,995 Epoch: 24/50	Step: [0/91]	Imp Loss: 2.5470	Imp Perplexity: 12.7692	Fin Loss: 2.2739	Imp Perplexity: 9.7168 
2023-04-01 19:07:25,679 Epoch: 24/50	Step: [50/91]	Imp Loss: 2.3871	Imp Perplexity: 10.8817	Fin Loss: 2.2520	Imp Perplexity: 9.5068 
2023-04-01 19:08:16,820 Epoch: 25/50	Step: [0/91]	Imp Loss: 2.2730	Imp Perplexity: 9.7089	Fin Loss: 2.1813	Imp Perplexity: 8.8575 
2023-04-01 19:08:58,583 Epoch: 25/50	Step: [50/91]	Imp Loss: 2.3598	Imp Perplexity: 10.5889	Fin Loss: 1.9677	Imp Perplexity: 7.1540 
2023-04-01 19:09:51,009 Epoch: 26/50	Step: [0/91]	Imp Loss: 2.3183	Imp Perplexity: 10.1589	Fin Loss: 1.7814	Imp Perplexity: 5.9382 
2023-04-01 19:10:31,362 Epoch: 26/50	Step: [50/91]	Imp Loss: 2.3331	Imp Perplexity: 10.3094	Fin Loss: 2.1721	Imp Perplexity: 8.7770 
2023-04-01 19:11:23,359 Epoch: 27/50	Step: [0/91]	Imp Loss: 2.5806	Imp Perplexity: 13.2048	Fin Loss: 1.9998	Imp Perplexity: 7.3874 
2023-04-01 19:12:03,416 Epoch: 27/50	Step: [50/91]	Imp Loss: 2.4541	Imp Perplexity: 11.6354	Fin Loss: 1.9862	Imp Perplexity: 7.2880 
2023-04-01 19:12:54,582 Epoch: 28/50	Step: [0/91]	Imp Loss: 2.1308	Imp Perplexity: 8.4215	Fin Loss: 1.9676	Imp Perplexity: 7.1536 
2023-04-01 19:13:34,810 Epoch: 28/50	Step: [50/91]	Imp Loss: 2.1474	Imp Perplexity: 8.5627	Fin Loss: 1.9293	Imp Perplexity: 6.8844 
2023-04-01 19:14:25,794 Epoch: 29/50	Step: [0/91]	Imp Loss: 2.2468	Imp Perplexity: 9.4578	Fin Loss: 1.8024	Imp Perplexity: 6.0645 
2023-04-01 19:15:05,934 Epoch: 29/50	Step: [50/91]	Imp Loss: 2.0743	Imp Perplexity: 7.9593	Fin Loss: 1.8486	Imp Perplexity: 6.3509 
2023-04-01 19:15:57,901 Epoch: 30/50	Step: [0/91]	Imp Loss: 2.2397	Imp Perplexity: 9.3906	Fin Loss: 1.9587	Imp Perplexity: 7.0902 
2023-04-01 19:16:38,256 Epoch: 30/50	Step: [50/91]	Imp Loss: 2.5083	Imp Perplexity: 12.2836	Fin Loss: 2.1992	Imp Perplexity: 9.0176 
2023-04-01 19:17:30,058 Epoch: 31/50	Step: [0/91]	Imp Loss: 2.4640	Imp Perplexity: 11.7521	Fin Loss: 1.9478	Imp Perplexity: 7.0133 
2023-04-01 19:18:10,213 Epoch: 31/50	Step: [50/91]	Imp Loss: 2.1660	Imp Perplexity: 8.7234	Fin Loss: 1.8717	Imp Perplexity: 6.4995 
2023-04-01 19:19:01,074 Epoch: 32/50	Step: [0/91]	Imp Loss: 2.2524	Imp Perplexity: 9.5108	Fin Loss: 1.9399	Imp Perplexity: 6.9580 
2023-04-01 19:19:41,061 Epoch: 32/50	Step: [50/91]	Imp Loss: 2.2384	Imp Perplexity: 9.3788	Fin Loss: 1.9144	Imp Perplexity: 6.7831 
2023-04-01 19:20:31,867 Epoch: 33/50	Step: [0/91]	Imp Loss: 2.1060	Imp Perplexity: 8.2155	Fin Loss: 1.9488	Imp Perplexity: 7.0201 
2023-04-01 19:21:11,843 Epoch: 33/50	Step: [50/91]	Imp Loss: 2.1962	Imp Perplexity: 8.9909	Fin Loss: 1.9563	Imp Perplexity: 7.0731 
2023-04-01 19:22:03,524 Epoch: 34/50	Step: [0/91]	Imp Loss: 2.3941	Imp Perplexity: 10.9582	Fin Loss: 1.9325	Imp Perplexity: 6.9070 
2023-04-01 19:22:43,597 Epoch: 34/50	Step: [50/91]	Imp Loss: 2.3521	Imp Perplexity: 10.5079	Fin Loss: 1.8976	Imp Perplexity: 6.6697 
2023-04-01 19:23:34,345 Epoch: 35/50	Step: [0/91]	Imp Loss: 2.2135	Imp Perplexity: 9.1480	Fin Loss: 2.0140	Imp Perplexity: 7.4933 
2023-04-01 19:24:18,217 Epoch: 35/50	Step: [50/91]	Imp Loss: 2.1724	Imp Perplexity: 8.7797	Fin Loss: 1.9071	Imp Perplexity: 6.7332 
2023-04-01 19:25:10,417 Epoch: 36/50	Step: [0/91]	Imp Loss: 2.2297	Imp Perplexity: 9.2974	Fin Loss: 1.8964	Imp Perplexity: 6.6617 
2023-04-01 19:25:50,506 Epoch: 36/50	Step: [50/91]	Imp Loss: 2.3342	Imp Perplexity: 10.3209	Fin Loss: 1.9708	Imp Perplexity: 7.1765 
2023-04-01 19:26:42,397 Epoch: 37/50	Step: [0/91]	Imp Loss: 1.9209	Imp Perplexity: 6.8273	Fin Loss: 1.8390	Imp Perplexity: 6.2904 
2023-04-01 19:27:22,542 Epoch: 37/50	Step: [50/91]	Imp Loss: 2.2668	Imp Perplexity: 9.6483	Fin Loss: 2.0592	Imp Perplexity: 7.8398 
2023-04-01 19:28:13,594 Epoch: 38/50	Step: [0/91]	Imp Loss: 2.4691	Imp Perplexity: 11.8121	Fin Loss: 1.8545	Imp Perplexity: 6.3887 
2023-04-01 19:28:53,599 Epoch: 38/50	Step: [50/91]	Imp Loss: 2.3592	Imp Perplexity: 10.5826	Fin Loss: 1.9221	Imp Perplexity: 6.8352 
2023-04-01 19:29:45,652 Epoch: 39/50	Step: [0/91]	Imp Loss: 1.8936	Imp Perplexity: 6.6434	Fin Loss: 1.9828	Imp Perplexity: 7.2629 
2023-04-01 19:30:25,694 Epoch: 39/50	Step: [50/91]	Imp Loss: 2.3595	Imp Perplexity: 10.5854	Fin Loss: 2.0897	Imp Perplexity: 8.0829 
2023-04-01 19:31:17,357 Epoch: 40/50	Step: [0/91]	Imp Loss: 2.1012	Imp Perplexity: 8.1756	Fin Loss: 1.8694	Imp Perplexity: 6.4842 
2023-04-01 19:31:57,658 Epoch: 40/50	Step: [50/91]	Imp Loss: 2.2372	Imp Perplexity: 9.3673	Fin Loss: 1.6910	Imp Perplexity: 5.4249 
2023-04-01 19:32:48,394 Epoch: 41/50	Step: [0/91]	Imp Loss: 2.1416	Imp Perplexity: 8.5131	Fin Loss: 1.8428	Imp Perplexity: 6.3144 
2023-04-01 19:33:28,293 Epoch: 41/50	Step: [50/91]	Imp Loss: 2.2429	Imp Perplexity: 9.4204	Fin Loss: 1.7318	Imp Perplexity: 5.6510 
2023-04-01 19:34:19,398 Epoch: 42/50	Step: [0/91]	Imp Loss: 2.1831	Imp Perplexity: 8.8737	Fin Loss: 2.0754	Imp Perplexity: 7.9679 
2023-04-01 19:34:59,311 Epoch: 42/50	Step: [50/91]	Imp Loss: 2.0095	Imp Perplexity: 7.4598	Fin Loss: 1.8285	Imp Perplexity: 6.2243 
2023-04-01 19:35:53,027 Epoch: 43/50	Step: [0/91]	Imp Loss: 1.9379	Imp Perplexity: 6.9440	Fin Loss: 1.8055	Imp Perplexity: 6.0829 
2023-04-01 19:36:34,053 Epoch: 43/50	Step: [50/91]	Imp Loss: 1.9826	Imp Perplexity: 7.2616	Fin Loss: 1.9263	Imp Perplexity: 6.8638 
2023-04-01 19:37:26,446 Epoch: 44/50	Step: [0/91]	Imp Loss: 2.0323	Imp Perplexity: 7.6317	Fin Loss: 1.6304	Imp Perplexity: 5.1059 
2023-04-01 19:38:07,367 Epoch: 44/50	Step: [50/91]	Imp Loss: 2.0836	Imp Perplexity: 8.0337	Fin Loss: 1.8344	Imp Perplexity: 6.2615 
2023-04-01 19:39:05,088 Epoch: 45/50	Step: [0/91]	Imp Loss: 1.7423	Imp Perplexity: 5.7104	Fin Loss: 1.7923	Imp Perplexity: 6.0030 
2023-04-01 19:39:45,914 Epoch: 45/50	Step: [50/91]	Imp Loss: 2.0547	Imp Perplexity: 7.8045	Fin Loss: 1.8061	Imp Perplexity: 6.0868 
2023-04-01 19:40:38,350 Epoch: 46/50	Step: [0/91]	Imp Loss: 2.1265	Imp Perplexity: 8.3852	Fin Loss: 1.9625	Imp Perplexity: 7.1174 
2023-04-01 19:41:19,134 Epoch: 46/50	Step: [50/91]	Imp Loss: 2.2231	Imp Perplexity: 9.2356	Fin Loss: 1.8470	Imp Perplexity: 6.3406 
2023-04-01 19:42:11,183 Epoch: 47/50	Step: [0/91]	Imp Loss: 2.1983	Imp Perplexity: 9.0101	Fin Loss: 1.7558	Imp Perplexity: 5.7879 
2023-04-01 19:42:52,378 Epoch: 47/50	Step: [50/91]	Imp Loss: 2.1840	Imp Perplexity: 8.8822	Fin Loss: 1.6842	Imp Perplexity: 5.3882 
2023-04-01 19:43:44,621 Epoch: 48/50	Step: [0/91]	Imp Loss: 2.1663	Imp Perplexity: 8.7260	Fin Loss: 1.8202	Imp Perplexity: 6.1732 
2023-04-01 19:44:25,280 Epoch: 48/50	Step: [50/91]	Imp Loss: 2.0116	Imp Perplexity: 7.4752	Fin Loss: 1.9501	Imp Perplexity: 7.0297 
2023-04-01 19:45:17,660 Epoch: 49/50	Step: [0/91]	Imp Loss: 2.2540	Imp Perplexity: 9.5259	Fin Loss: 1.8277	Imp Perplexity: 6.2193 
2023-04-01 19:45:58,181 Epoch: 49/50	Step: [50/91]	Imp Loss: 2.1820	Imp Perplexity: 8.8644	Fin Loss: 1.7578	Imp Perplexity: 5.7999 
2023-04-01 19:46:51,898 Epoch: 50/50	Step: [0/91]	Imp Loss: 2.1945	Imp Perplexity: 8.9757	Fin Loss: 1.9623	Imp Perplexity: 7.1160 
2023-04-01 19:47:33,367 Epoch: 50/50	Step: [50/91]	Imp Loss: 2.2010	Imp Perplexity: 9.0340	Fin Loss: 1.7119	Imp Perplexity: 5.5397 
2023-04-01 19:48:25,164 Values of metric for the best model are: 
 BLEU:[0.4175, 0.2978, 0.2109, 0.1533], METEOR:0.1783, ROUGE:0.3538, Cider:0.2216
2023-04-01 19:48:25,164 Save the best model weights when epoch [11/50], BLEU4:0.1533
2023-04-01 19:48:25,164 =======================================================
2023-04-01 19:48:25,267 Start the 2th run of the same model
2023-04-01 19:48:28,164 Epoch: 1/50	Step: [0/91]	Imp Loss: 7.5996	Imp Perplexity: 1997.3565	Fin Loss: 7.5881	Imp Perplexity: 1974.5149 
2023-04-01 19:49:08,738 Epoch: 1/50	Step: [50/91]	Imp Loss: 4.1412	Imp Perplexity: 62.8798	Fin Loss: 4.3463	Imp Perplexity: 77.1885 
2023-04-01 19:49:58,608 The model performance improved when epoch [1/50], BLEU4:0.0115
2023-04-01 19:49:59,786 Epoch: 2/50	Step: [0/91]	Imp Loss: 3.2906	Imp Perplexity: 26.8589	Fin Loss: 4.1842	Imp Perplexity: 65.6379 
2023-04-01 19:50:40,472 Epoch: 2/50	Step: [50/91]	Imp Loss: 3.2221	Imp Perplexity: 25.0797	Fin Loss: 3.9227	Imp Perplexity: 50.5342 
2023-04-01 19:51:31,476 The model performance improved when epoch [2/50], BLEU4:0.0708
2023-04-01 19:51:32,790 Epoch: 3/50	Step: [0/91]	Imp Loss: 3.3411	Imp Perplexity: 28.2511	Fin Loss: 3.8039	Imp Perplexity: 44.8754 
2023-04-01 19:52:13,463 Epoch: 3/50	Step: [50/91]	Imp Loss: 3.2779	Imp Perplexity: 26.5207	Fin Loss: 3.4624	Imp Perplexity: 31.8948 
2023-04-01 19:53:04,273 The model performance improved when epoch [3/50], BLEU4:0.0867
2023-04-01 19:53:05,622 Epoch: 4/50	Step: [0/91]	Imp Loss: 3.2258	Imp Perplexity: 25.1744	Fin Loss: 3.4583	Imp Perplexity: 31.7645 
2023-04-01 19:53:46,532 Epoch: 4/50	Step: [50/91]	Imp Loss: 2.9878	Imp Perplexity: 19.8419	Fin Loss: 3.2809	Imp Perplexity: 26.5991 
2023-04-01 19:54:41,042 The model performance improved when epoch [4/50], BLEU4:0.0877
2023-04-01 19:54:42,308 Epoch: 5/50	Step: [0/91]	Imp Loss: 3.3365	Imp Perplexity: 28.1212	Fin Loss: 3.2048	Imp Perplexity: 24.6514 
2023-04-01 19:55:23,121 Epoch: 5/50	Step: [50/91]	Imp Loss: 2.7822	Imp Perplexity: 16.1539	Fin Loss: 3.0955	Imp Perplexity: 22.0990 
2023-04-01 19:56:15,951 Epoch: 6/50	Step: [0/91]	Imp Loss: 2.8697	Imp Perplexity: 17.6317	Fin Loss: 3.0917	Imp Perplexity: 22.0149 
2023-04-01 19:56:59,421 Epoch: 6/50	Step: [50/91]	Imp Loss: 2.9534	Imp Perplexity: 19.1707	Fin Loss: 3.0297	Imp Perplexity: 20.6913 
2023-04-01 19:57:52,815 Epoch: 7/50	Step: [0/91]	Imp Loss: 2.8155	Imp Perplexity: 16.7020	Fin Loss: 3.0356	Imp Perplexity: 20.8132 
2023-04-01 19:58:33,466 Epoch: 7/50	Step: [50/91]	Imp Loss: 2.5654	Imp Perplexity: 13.0055	Fin Loss: 2.7082	Imp Perplexity: 15.0020 
2023-04-01 19:59:26,251 Epoch: 8/50	Step: [0/91]	Imp Loss: 2.6197	Imp Perplexity: 13.7311	Fin Loss: 2.9564	Imp Perplexity: 19.2293 
2023-04-01 20:00:08,445 Epoch: 8/50	Step: [50/91]	Imp Loss: 2.9861	Imp Perplexity: 19.8078	Fin Loss: 3.1051	Imp Perplexity: 22.3125 
2023-04-01 20:01:00,057 The model performance improved when epoch [8/50], BLEU4:0.1266
2023-04-01 20:01:01,285 Epoch: 9/50	Step: [0/91]	Imp Loss: 2.7530	Imp Perplexity: 15.6901	Fin Loss: 2.6233	Imp Perplexity: 13.7805 
2023-04-01 20:01:41,981 Epoch: 9/50	Step: [50/91]	Imp Loss: 2.6204	Imp Perplexity: 13.7415	Fin Loss: 2.8652	Imp Perplexity: 17.5522 
2023-04-01 20:02:33,306 The model performance improved when epoch [9/50], BLEU4:0.1657
2023-04-01 20:02:34,520 Epoch: 10/50	Step: [0/91]	Imp Loss: 2.2046	Imp Perplexity: 9.0669	Fin Loss: 2.6549	Imp Perplexity: 14.2242 
2023-04-01 20:03:15,653 Epoch: 10/50	Step: [50/91]	Imp Loss: 2.4227	Imp Perplexity: 11.2765	Fin Loss: 2.7377	Imp Perplexity: 15.4508 
2023-04-01 20:04:07,758 Epoch: 11/50	Step: [0/91]	Imp Loss: 2.6751	Imp Perplexity: 14.5138	Fin Loss: 2.4466	Imp Perplexity: 11.5486 
2023-04-01 20:04:48,351 Epoch: 11/50	Step: [50/91]	Imp Loss: 2.5609	Imp Perplexity: 12.9475	Fin Loss: 2.6559	Imp Perplexity: 14.2384 
2023-04-01 20:05:40,569 Epoch: 12/50	Step: [0/91]	Imp Loss: 2.7614	Imp Perplexity: 15.8213	Fin Loss: 2.3775	Imp Perplexity: 10.7778 
2023-04-01 20:06:21,324 Epoch: 12/50	Step: [50/91]	Imp Loss: 2.1825	Imp Perplexity: 8.8688	Fin Loss: 2.2250	Imp Perplexity: 9.2536 
2023-04-01 20:07:13,400 Epoch: 13/50	Step: [0/91]	Imp Loss: 2.7711	Imp Perplexity: 15.9758	Fin Loss: 2.7192	Imp Perplexity: 15.1687 
2023-04-01 20:07:54,460 Epoch: 13/50	Step: [50/91]	Imp Loss: 2.4329	Imp Perplexity: 11.3920	Fin Loss: 2.5151	Imp Perplexity: 12.3678 
2023-04-01 20:08:46,042 Epoch: 14/50	Step: [0/91]	Imp Loss: 2.5823	Imp Perplexity: 13.2281	Fin Loss: 2.6013	Imp Perplexity: 13.4815 
2023-04-01 20:09:31,367 Epoch: 14/50	Step: [50/91]	Imp Loss: 2.3071	Imp Perplexity: 10.0452	Fin Loss: 2.3498	Imp Perplexity: 10.4838 
2023-04-01 20:10:22,100 Epoch: 15/50	Step: [0/91]	Imp Loss: 2.9424	Imp Perplexity: 18.9605	Fin Loss: 2.6047	Imp Perplexity: 13.5273 
2023-04-01 20:11:02,023 Epoch: 15/50	Step: [50/91]	Imp Loss: 2.6171	Imp Perplexity: 13.6963	Fin Loss: 2.3532	Imp Perplexity: 10.5196 
2023-04-01 20:11:53,751 Epoch: 16/50	Step: [0/91]	Imp Loss: 2.2933	Imp Perplexity: 9.9076	Fin Loss: 2.2436	Imp Perplexity: 9.4271 
2023-04-01 20:12:34,353 Epoch: 16/50	Step: [50/91]	Imp Loss: 2.9822	Imp Perplexity: 19.7308	Fin Loss: 2.2655	Imp Perplexity: 9.6361 
2023-04-01 20:13:25,832 Epoch: 17/50	Step: [0/91]	Imp Loss: 2.3594	Imp Perplexity: 10.5844	Fin Loss: 2.3578	Imp Perplexity: 10.5675 
2023-04-01 20:14:06,711 Epoch: 17/50	Step: [50/91]	Imp Loss: 2.3441	Imp Perplexity: 10.4242	Fin Loss: 2.2291	Imp Perplexity: 9.2917 
2023-04-01 20:14:58,108 Epoch: 18/50	Step: [0/91]	Imp Loss: 2.3785	Imp Perplexity: 10.7892	Fin Loss: 2.2726	Imp Perplexity: 9.7044 
2023-04-01 20:15:38,132 Epoch: 18/50	Step: [50/91]	Imp Loss: 2.3411	Imp Perplexity: 10.3925	Fin Loss: 2.2343	Imp Perplexity: 9.3398 
2023-04-01 20:16:30,377 Epoch: 19/50	Step: [0/91]	Imp Loss: 2.7750	Imp Perplexity: 16.0380	Fin Loss: 2.0447	Imp Perplexity: 7.7266 
2023-04-01 20:17:10,867 Epoch: 19/50	Step: [50/91]	Imp Loss: 2.1113	Imp Perplexity: 8.2590	Fin Loss: 2.1690	Imp Perplexity: 8.7492 
2023-04-01 20:18:02,440 Epoch: 20/50	Step: [0/91]	Imp Loss: 2.0829	Imp Perplexity: 8.0276	Fin Loss: 2.2344	Imp Perplexity: 9.3411 
2023-04-01 20:18:42,635 Epoch: 20/50	Step: [50/91]	Imp Loss: 2.4266	Imp Perplexity: 11.3205	Fin Loss: 2.2402	Imp Perplexity: 9.3952 
2023-04-01 20:19:33,923 Epoch: 21/50	Step: [0/91]	Imp Loss: 2.0251	Imp Perplexity: 7.5772	Fin Loss: 2.3362	Imp Perplexity: 10.3414 
2023-04-01 20:20:14,052 Epoch: 21/50	Step: [50/91]	Imp Loss: 2.4691	Imp Perplexity: 11.8116	Fin Loss: 2.2249	Imp Perplexity: 9.2528 
2023-04-01 20:21:05,391 Epoch: 22/50	Step: [0/91]	Imp Loss: 2.1631	Imp Perplexity: 8.6984	Fin Loss: 2.2958	Imp Perplexity: 9.9319 
2023-04-01 20:21:45,484 Epoch: 22/50	Step: [50/91]	Imp Loss: 2.5931	Imp Perplexity: 13.3708	Fin Loss: 2.3442	Imp Perplexity: 10.4249 
2023-04-01 20:22:36,838 Epoch: 23/50	Step: [0/91]	Imp Loss: 2.3561	Imp Perplexity: 10.5494	Fin Loss: 2.2748	Imp Perplexity: 9.7261 
2023-04-01 20:23:17,076 Epoch: 23/50	Step: [50/91]	Imp Loss: 2.4881	Imp Perplexity: 12.0383	Fin Loss: 2.0667	Imp Perplexity: 7.8985 
2023-04-01 20:24:11,129 Epoch: 24/50	Step: [0/91]	Imp Loss: 2.3807	Imp Perplexity: 10.8123	Fin Loss: 2.2572	Imp Perplexity: 9.5563 
2023-04-01 20:24:51,490 Epoch: 24/50	Step: [50/91]	Imp Loss: 2.2977	Imp Perplexity: 9.9514	Fin Loss: 2.1839	Imp Perplexity: 8.8811 
2023-04-01 20:25:43,072 Epoch: 25/50	Step: [0/91]	Imp Loss: 2.5014	Imp Perplexity: 12.2000	Fin Loss: 2.0884	Imp Perplexity: 8.0723 
2023-04-01 20:26:23,628 Epoch: 25/50	Step: [50/91]	Imp Loss: 2.5468	Imp Perplexity: 12.7661	Fin Loss: 2.4669	Imp Perplexity: 11.7857 
2023-04-01 20:27:15,386 Epoch: 26/50	Step: [0/91]	Imp Loss: 2.5391	Imp Perplexity: 12.6688	Fin Loss: 2.0192	Imp Perplexity: 7.5325 
2023-04-01 20:27:55,853 Epoch: 26/50	Step: [50/91]	Imp Loss: 2.5021	Imp Perplexity: 12.2079	Fin Loss: 2.0815	Imp Perplexity: 8.0166 
2023-04-01 20:28:47,513 Epoch: 27/50	Step: [0/91]	Imp Loss: 2.5897	Imp Perplexity: 13.3259	Fin Loss: 1.7886	Imp Perplexity: 5.9812 
2023-04-01 20:29:27,897 Epoch: 27/50	Step: [50/91]	Imp Loss: 2.1838	Imp Perplexity: 8.8800	Fin Loss: 2.1438	Imp Perplexity: 8.5318 
2023-04-01 20:30:19,650 Epoch: 28/50	Step: [0/91]	Imp Loss: 2.1595	Imp Perplexity: 8.6671	Fin Loss: 2.0633	Imp Perplexity: 7.8722 
2023-04-01 20:31:00,215 Epoch: 28/50	Step: [50/91]	Imp Loss: 2.1695	Imp Perplexity: 8.7537	Fin Loss: 2.0095	Imp Perplexity: 7.4593 
2023-04-01 20:31:51,985 Epoch: 29/50	Step: [0/91]	Imp Loss: 2.2334	Imp Perplexity: 9.3319	Fin Loss: 2.0242	Imp Perplexity: 7.5704 
2023-04-01 20:32:32,359 Epoch: 29/50	Step: [50/91]	Imp Loss: 2.3977	Imp Perplexity: 10.9981	Fin Loss: 2.1337	Imp Perplexity: 8.4458 
2023-04-01 20:33:24,133 Epoch: 30/50	Step: [0/91]	Imp Loss: 2.3575	Imp Perplexity: 10.5640	Fin Loss: 2.0617	Imp Perplexity: 7.8593 
2023-04-01 20:34:04,460 Epoch: 30/50	Step: [50/91]	Imp Loss: 2.2563	Imp Perplexity: 9.5476	Fin Loss: 2.0638	Imp Perplexity: 7.8760 
2023-04-01 20:34:56,096 Epoch: 31/50	Step: [0/91]	Imp Loss: 2.3295	Imp Perplexity: 10.2731	Fin Loss: 1.9538	Imp Perplexity: 7.0555 
2023-04-01 20:35:36,464 Epoch: 31/50	Step: [50/91]	Imp Loss: 2.2523	Imp Perplexity: 9.5093	Fin Loss: 2.2049	Imp Perplexity: 9.0692 
2023-04-01 20:36:27,997 Epoch: 32/50	Step: [0/91]	Imp Loss: 2.1949	Imp Perplexity: 8.9794	Fin Loss: 2.0805	Imp Perplexity: 8.0083 
2023-04-01 20:37:08,315 Epoch: 32/50	Step: [50/91]	Imp Loss: 2.3521	Imp Perplexity: 10.5080	Fin Loss: 2.1375	Imp Perplexity: 8.4782 
2023-04-01 20:38:00,060 Epoch: 33/50	Step: [0/91]	Imp Loss: 2.4361	Imp Perplexity: 11.4280	Fin Loss: 2.0110	Imp Perplexity: 7.4711 
2023-04-01 20:38:40,304 Epoch: 33/50	Step: [50/91]	Imp Loss: 2.1048	Imp Perplexity: 8.2057	Fin Loss: 2.0352	Imp Perplexity: 7.6541 
2023-04-01 20:39:38,772 Epoch: 34/50	Step: [0/91]	Imp Loss: 2.3735	Imp Perplexity: 10.7349	Fin Loss: 1.8684	Imp Perplexity: 6.4782 
2023-04-01 20:40:20,271 Epoch: 34/50	Step: [50/91]	Imp Loss: 1.9427	Imp Perplexity: 6.9778	Fin Loss: 1.9256	Imp Perplexity: 6.8593 
2023-04-01 20:41:15,297 Epoch: 35/50	Step: [0/91]	Imp Loss: 2.1623	Imp Perplexity: 8.6908	Fin Loss: 2.0458	Imp Perplexity: 7.7354 
2023-04-01 20:41:57,044 Epoch: 35/50	Step: [50/91]	Imp Loss: 1.9063	Imp Perplexity: 6.7283	Fin Loss: 1.8598	Imp Perplexity: 6.4225 
2023-04-01 20:42:51,261 Epoch: 36/50	Step: [0/91]	Imp Loss: 1.8202	Imp Perplexity: 6.1731	Fin Loss: 1.8422	Imp Perplexity: 6.3103 
2023-04-01 20:43:32,272 Epoch: 36/50	Step: [50/91]	Imp Loss: 2.2935	Imp Perplexity: 9.9092	Fin Loss: 1.9098	Imp Perplexity: 6.7514 
2023-04-01 20:44:25,440 Epoch: 37/50	Step: [0/91]	Imp Loss: 2.0837	Imp Perplexity: 8.0340	Fin Loss: 2.0644	Imp Perplexity: 7.8807 
2023-04-01 20:45:06,447 Epoch: 37/50	Step: [50/91]	Imp Loss: 1.7799	Imp Perplexity: 5.9295	Fin Loss: 1.8301	Imp Perplexity: 6.2344 
2023-04-01 20:46:00,634 Epoch: 38/50	Step: [0/91]	Imp Loss: 2.4371	Imp Perplexity: 11.4394	Fin Loss: 1.9577	Imp Perplexity: 7.0828 
2023-04-01 20:46:42,123 Epoch: 38/50	Step: [50/91]	Imp Loss: 2.0330	Imp Perplexity: 7.6370	Fin Loss: 1.6888	Imp Perplexity: 5.4127 
2023-04-01 20:47:35,826 Epoch: 39/50	Step: [0/91]	Imp Loss: 2.3495	Imp Perplexity: 10.4803	Fin Loss: 1.7581	Imp Perplexity: 5.8013 
2023-04-01 20:48:17,134 Epoch: 39/50	Step: [50/91]	Imp Loss: 2.0862	Imp Perplexity: 8.0544	Fin Loss: 1.9935	Imp Perplexity: 7.3409 
2023-04-01 20:49:10,399 Epoch: 40/50	Step: [0/91]	Imp Loss: 2.0889	Imp Perplexity: 8.0764	Fin Loss: 1.8441	Imp Perplexity: 6.3224 
2023-04-01 20:49:52,516 Epoch: 40/50	Step: [50/91]	Imp Loss: 1.8694	Imp Perplexity: 6.4841	Fin Loss: 1.8754	Imp Perplexity: 6.5233 
2023-04-01 20:50:47,351 Epoch: 41/50	Step: [0/91]	Imp Loss: 2.4635	Imp Perplexity: 11.7463	Fin Loss: 1.8451	Imp Perplexity: 6.3288 
2023-04-01 20:51:28,890 Epoch: 41/50	Step: [50/91]	Imp Loss: 2.2655	Imp Perplexity: 9.6358	Fin Loss: 1.7689	Imp Perplexity: 5.8642 
2023-04-01 20:52:21,935 Epoch: 42/50	Step: [0/91]	Imp Loss: 2.2118	Imp Perplexity: 9.1321	Fin Loss: 1.8153	Imp Perplexity: 6.1432 
2023-04-01 20:53:03,377 Epoch: 42/50	Step: [50/91]	Imp Loss: 1.9983	Imp Perplexity: 7.3765	Fin Loss: 1.8464	Imp Perplexity: 6.3371 
2023-04-01 20:54:03,332 Epoch: 43/50	Step: [0/91]	Imp Loss: 2.0878	Imp Perplexity: 8.0668	Fin Loss: 1.7544	Imp Perplexity: 5.7802 
2023-04-01 20:54:44,224 Epoch: 43/50	Step: [50/91]	Imp Loss: 2.0694	Imp Perplexity: 7.9197	Fin Loss: 1.8705	Imp Perplexity: 6.4915 
2023-04-01 20:55:37,053 Epoch: 44/50	Step: [0/91]	Imp Loss: 2.1603	Imp Perplexity: 8.6733	Fin Loss: 1.8702	Imp Perplexity: 6.4899 
2023-04-01 20:56:18,858 Epoch: 44/50	Step: [50/91]	Imp Loss: 2.1770	Imp Perplexity: 8.8194	Fin Loss: 1.8540	Imp Perplexity: 6.3850 
2023-04-01 20:57:12,198 Epoch: 45/50	Step: [0/91]	Imp Loss: 2.0296	Imp Perplexity: 7.6113	Fin Loss: 1.9011	Imp Perplexity: 6.6933 
2023-04-01 20:57:53,475 Epoch: 45/50	Step: [50/91]	Imp Loss: 2.1795	Imp Perplexity: 8.8422	Fin Loss: 1.7372	Imp Perplexity: 5.6817 
2023-04-01 20:58:46,769 Epoch: 46/50	Step: [0/91]	Imp Loss: 2.2619	Imp Perplexity: 9.6015	Fin Loss: 1.7058	Imp Perplexity: 5.5057 
2023-04-01 20:59:27,741 Epoch: 46/50	Step: [50/91]	Imp Loss: 2.0572	Imp Perplexity: 7.8237	Fin Loss: 1.9333	Imp Perplexity: 6.9125 
2023-04-01 21:00:20,486 Epoch: 47/50	Step: [0/91]	Imp Loss: 1.9787	Imp Perplexity: 7.2336	Fin Loss: 1.7262	Imp Perplexity: 5.6195 
2023-04-01 21:01:02,070 Epoch: 47/50	Step: [50/91]	Imp Loss: 1.9936	Imp Perplexity: 7.3418	Fin Loss: 1.8231	Imp Perplexity: 6.1907 
2023-04-01 21:01:54,878 Epoch: 48/50	Step: [0/91]	Imp Loss: 2.0298	Imp Perplexity: 7.6123	Fin Loss: 1.8240	Imp Perplexity: 6.1969 
2023-04-01 21:02:35,944 Epoch: 48/50	Step: [50/91]	Imp Loss: 2.1796	Imp Perplexity: 8.8427	Fin Loss: 1.8221	Imp Perplexity: 6.1847 
2023-04-01 21:03:28,052 Epoch: 49/50	Step: [0/91]	Imp Loss: 2.1785	Imp Perplexity: 8.8333	Fin Loss: 1.7170	Imp Perplexity: 5.5679 
2023-04-01 21:04:09,000 Epoch: 49/50	Step: [50/91]	Imp Loss: 2.1390	Imp Perplexity: 8.4911	Fin Loss: 1.7785	Imp Perplexity: 5.9210 
2023-04-01 21:05:02,217 Epoch: 50/50	Step: [0/91]	Imp Loss: 2.2275	Imp Perplexity: 9.2768	Fin Loss: 1.8043	Imp Perplexity: 6.0755 
2023-04-01 21:05:44,162 Epoch: 50/50	Step: [50/91]	Imp Loss: 2.3193	Imp Perplexity: 10.1682	Fin Loss: 1.7413	Imp Perplexity: 5.7046 
2023-04-01 21:06:37,126 Values of metric for the best model are: 
 BLEU:[0.3831, 0.2856, 0.2182, 0.1657], METEOR:0.1968, ROUGE:0.3375, Cider:0.1176
2023-04-01 21:06:37,126 Save the best model weights when epoch [9/50], BLEU4:0.1657
2023-04-01 21:06:37,126 =======================================================
2023-04-01 21:06:37,132 Start the 3th run of the same model
2023-04-01 21:06:40,096 Epoch: 1/50	Step: [0/91]	Imp Loss: 7.6146	Imp Perplexity: 2027.5530	Fin Loss: 7.6005	Imp Perplexity: 1999.2098 
2023-04-01 21:07:21,646 Epoch: 1/50	Step: [50/91]	Imp Loss: 4.5847	Imp Perplexity: 97.9755	Fin Loss: 4.5627	Imp Perplexity: 95.8442 
2023-04-01 21:08:16,588 The model performance improved when epoch [1/50], BLEU4:0.0343
2023-04-01 21:08:17,901 Epoch: 2/50	Step: [0/91]	Imp Loss: 3.6612	Imp Perplexity: 38.9070	Fin Loss: 3.9913	Imp Perplexity: 54.1264 
2023-04-01 21:09:01,896 Epoch: 2/50	Step: [50/91]	Imp Loss: 2.8624	Imp Perplexity: 17.5039	Fin Loss: 3.8491	Imp Perplexity: 46.9531 
2023-04-01 21:09:55,362 The model performance improved when epoch [2/50], BLEU4:0.0788
2023-04-01 21:09:56,632 Epoch: 3/50	Step: [0/91]	Imp Loss: 3.2679	Imp Perplexity: 26.2562	Fin Loss: 3.4865	Imp Perplexity: 32.6703 
2023-04-01 21:10:37,344 Epoch: 3/50	Step: [50/91]	Imp Loss: 3.5744	Imp Perplexity: 35.6741	Fin Loss: 3.5284	Imp Perplexity: 34.0681 
2023-04-01 21:11:29,562 Epoch: 4/50	Step: [0/91]	Imp Loss: 2.8998	Imp Perplexity: 18.1710	Fin Loss: 3.2854	Imp Perplexity: 26.7199 
2023-04-01 21:12:09,979 Epoch: 4/50	Step: [50/91]	Imp Loss: 2.7010	Imp Perplexity: 14.8948	Fin Loss: 3.1370	Imp Perplexity: 23.0337 
2023-04-01 21:13:00,887 The model performance improved when epoch [4/50], BLEU4:0.0837
2023-04-01 21:13:02,148 Epoch: 5/50	Step: [0/91]	Imp Loss: 2.9499	Imp Perplexity: 19.1047	Fin Loss: 3.3404	Imp Perplexity: 28.2309 
2023-04-01 21:13:42,535 Epoch: 5/50	Step: [50/91]	Imp Loss: 2.6028	Imp Perplexity: 13.5019	Fin Loss: 3.0224	Imp Perplexity: 20.5402 
2023-04-01 21:14:35,321 Epoch: 6/50	Step: [0/91]	Imp Loss: 2.7085	Imp Perplexity: 15.0069	Fin Loss: 2.9693	Imp Perplexity: 19.4777 
2023-04-01 21:15:17,003 Epoch: 6/50	Step: [50/91]	Imp Loss: 2.8672	Imp Perplexity: 17.5876	Fin Loss: 3.1515	Imp Perplexity: 23.3699 
2023-04-01 21:16:07,875 The model performance improved when epoch [6/50], BLEU4:0.1134
2023-04-01 21:16:09,194 Epoch: 7/50	Step: [0/91]	Imp Loss: 2.5826	Imp Perplexity: 13.2313	Fin Loss: 2.9405	Imp Perplexity: 18.9256 
2023-04-01 21:16:50,209 Epoch: 7/50	Step: [50/91]	Imp Loss: 2.5777	Imp Perplexity: 13.1668	Fin Loss: 2.5881	Imp Perplexity: 13.3047 
2023-04-01 21:17:41,033 The model performance improved when epoch [7/50], BLEU4:0.152
2023-04-01 21:17:42,304 Epoch: 8/50	Step: [0/91]	Imp Loss: 2.8520	Imp Perplexity: 17.3216	Fin Loss: 2.7008	Imp Perplexity: 14.8922 
2023-04-01 21:18:24,672 Epoch: 8/50	Step: [50/91]	Imp Loss: 2.8270	Imp Perplexity: 16.8953	Fin Loss: 2.8753	Imp Perplexity: 17.7300 
2023-04-01 21:19:18,386 Epoch: 9/50	Step: [0/91]	Imp Loss: 2.7933	Imp Perplexity: 16.3356	Fin Loss: 2.6377	Imp Perplexity: 13.9815 
2023-04-01 21:20:00,239 Epoch: 9/50	Step: [50/91]	Imp Loss: 2.6553	Imp Perplexity: 14.2289	Fin Loss: 2.6277	Imp Perplexity: 13.8416 
2023-04-01 21:20:58,962 Epoch: 10/50	Step: [0/91]	Imp Loss: 2.6555	Imp Perplexity: 14.2327	Fin Loss: 2.7350	Imp Perplexity: 15.4095 
2023-04-01 21:21:50,341 Epoch: 10/50	Step: [50/91]	Imp Loss: 2.6400	Imp Perplexity: 14.0131	Fin Loss: 2.4701	Imp Perplexity: 11.8241 
2023-04-01 21:22:46,457 Epoch: 11/50	Step: [0/91]	Imp Loss: 2.8037	Imp Perplexity: 16.5056	Fin Loss: 2.6548	Imp Perplexity: 14.2225 
2023-04-01 21:23:27,897 Epoch: 11/50	Step: [50/91]	Imp Loss: 2.7086	Imp Perplexity: 15.0079	Fin Loss: 2.7529	Imp Perplexity: 15.6885 
2023-04-01 21:24:27,581 Epoch: 12/50	Step: [0/91]	Imp Loss: 2.8927	Imp Perplexity: 18.0412	Fin Loss: 2.7414	Imp Perplexity: 15.5084 
2023-04-01 21:25:09,721 Epoch: 12/50	Step: [50/91]	Imp Loss: 2.4253	Imp Perplexity: 11.3051	Fin Loss: 2.5867	Imp Perplexity: 13.2853 
2023-04-01 21:26:02,873 Epoch: 13/50	Step: [0/91]	Imp Loss: 2.6041	Imp Perplexity: 13.5193	Fin Loss: 2.4528	Imp Perplexity: 11.6205 
2023-04-01 21:26:44,480 Epoch: 13/50	Step: [50/91]	Imp Loss: 2.5677	Imp Perplexity: 13.0353	Fin Loss: 2.5733	Imp Perplexity: 13.1092 
2023-04-01 21:27:37,824 Epoch: 14/50	Step: [0/91]	Imp Loss: 2.5906	Imp Perplexity: 13.3379	Fin Loss: 2.6236	Imp Perplexity: 13.7858 
2023-04-01 21:28:19,844 Epoch: 14/50	Step: [50/91]	Imp Loss: 2.4419	Imp Perplexity: 11.4945	Fin Loss: 2.5336	Imp Perplexity: 12.5982 
2023-04-01 21:29:13,591 Epoch: 15/50	Step: [0/91]	Imp Loss: 2.3053	Imp Perplexity: 10.0274	Fin Loss: 2.5101	Imp Perplexity: 12.3063 
2023-04-01 21:29:55,075 Epoch: 15/50	Step: [50/91]	Imp Loss: 2.5168	Imp Perplexity: 12.3887	Fin Loss: 2.5145	Imp Perplexity: 12.3604 
2023-04-01 21:30:47,467 The model performance improved when epoch [15/50], BLEU4:0.1703
2023-04-01 21:30:48,834 Epoch: 16/50	Step: [0/91]	Imp Loss: 2.2277	Imp Perplexity: 9.2788	Fin Loss: 2.3944	Imp Perplexity: 10.9614 
2023-04-01 21:31:31,475 Epoch: 16/50	Step: [50/91]	Imp Loss: 2.7167	Imp Perplexity: 15.1309	Fin Loss: 2.2812	Imp Perplexity: 9.7886 
2023-04-01 21:32:25,116 Epoch: 17/50	Step: [0/91]	Imp Loss: 2.4832	Imp Perplexity: 11.9797	Fin Loss: 2.3532	Imp Perplexity: 10.5188 
2023-04-01 21:33:06,123 Epoch: 17/50	Step: [50/91]	Imp Loss: 2.3439	Imp Perplexity: 10.4216	Fin Loss: 2.2294	Imp Perplexity: 9.2947 
2023-04-01 21:33:58,286 Epoch: 18/50	Step: [0/91]	Imp Loss: 2.3818	Imp Perplexity: 10.8240	Fin Loss: 2.2100	Imp Perplexity: 9.1154 
2023-04-01 21:34:39,021 Epoch: 18/50	Step: [50/91]	Imp Loss: 2.0492	Imp Perplexity: 7.7621	Fin Loss: 1.8994	Imp Perplexity: 6.6816 
2023-04-01 21:35:30,838 Epoch: 19/50	Step: [0/91]	Imp Loss: 2.4236	Imp Perplexity: 11.2864	Fin Loss: 2.2119	Imp Perplexity: 9.1332 
2023-04-01 21:36:11,560 Epoch: 19/50	Step: [50/91]	Imp Loss: 2.6621	Imp Perplexity: 14.3262	Fin Loss: 2.2713	Imp Perplexity: 9.6915 
2023-04-01 21:37:03,419 Epoch: 20/50	Step: [0/91]	Imp Loss: 2.1714	Imp Perplexity: 8.7707	Fin Loss: 2.1229	Imp Perplexity: 8.3550 
2023-04-01 21:37:43,857 Epoch: 20/50	Step: [50/91]	Imp Loss: 1.9720	Imp Perplexity: 7.1852	Fin Loss: 1.8825	Imp Perplexity: 6.5698 
2023-04-01 21:38:35,780 Epoch: 21/50	Step: [0/91]	Imp Loss: 2.4952	Imp Perplexity: 12.1247	Fin Loss: 2.1291	Imp Perplexity: 8.4073 
2023-04-01 21:39:22,202 Epoch: 21/50	Step: [50/91]	Imp Loss: 2.3781	Imp Perplexity: 10.7839	Fin Loss: 2.0345	Imp Perplexity: 7.6481 
2023-04-01 21:40:14,512 Epoch: 22/50	Step: [0/91]	Imp Loss: 2.5324	Imp Perplexity: 12.5838	Fin Loss: 2.2822	Imp Perplexity: 9.7978 
2023-04-01 21:40:55,104 Epoch: 22/50	Step: [50/91]	Imp Loss: 2.5501	Imp Perplexity: 12.8079	Fin Loss: 2.1814	Imp Perplexity: 8.8588 
2023-04-01 21:41:46,851 Epoch: 23/50	Step: [0/91]	Imp Loss: 2.4778	Imp Perplexity: 11.9146	Fin Loss: 2.2475	Imp Perplexity: 9.4643 
2023-04-01 21:42:27,179 Epoch: 23/50	Step: [50/91]	Imp Loss: 2.2890	Imp Perplexity: 9.8647	Fin Loss: 2.2683	Imp Perplexity: 9.6632 
2023-04-01 21:43:20,808 Epoch: 24/50	Step: [0/91]	Imp Loss: 2.4481	Imp Perplexity: 11.5664	Fin Loss: 2.0471	Imp Perplexity: 7.7452 
2023-04-01 21:44:02,823 Epoch: 24/50	Step: [50/91]	Imp Loss: 2.4236	Imp Perplexity: 11.2865	Fin Loss: 2.0775	Imp Perplexity: 7.9849 
2023-04-01 21:44:55,762 Epoch: 25/50	Step: [0/91]	Imp Loss: 2.3594	Imp Perplexity: 10.5849	Fin Loss: 2.2576	Imp Perplexity: 9.5604 
2023-04-01 21:45:36,610 Epoch: 25/50	Step: [50/91]	Imp Loss: 2.5840	Imp Perplexity: 13.2494	Fin Loss: 2.2673	Imp Perplexity: 9.6531 
2023-04-01 21:46:28,712 Epoch: 26/50	Step: [0/91]	Imp Loss: 2.3220	Imp Perplexity: 10.1962	Fin Loss: 2.0353	Imp Perplexity: 7.6549 
2023-04-01 21:47:09,568 Epoch: 26/50	Step: [50/91]	Imp Loss: 2.5739	Imp Perplexity: 13.1173	Fin Loss: 2.0487	Imp Perplexity: 7.7575 
2023-04-01 21:48:01,889 Epoch: 27/50	Step: [0/91]	Imp Loss: 2.3612	Imp Perplexity: 10.6034	Fin Loss: 2.2751	Imp Perplexity: 9.7289 
2023-04-01 21:48:42,738 Epoch: 27/50	Step: [50/91]	Imp Loss: 2.3449	Imp Perplexity: 10.4318	Fin Loss: 2.0553	Imp Perplexity: 7.8089 
2023-04-01 21:49:34,604 Epoch: 28/50	Step: [0/91]	Imp Loss: 2.3226	Imp Perplexity: 10.2024	Fin Loss: 1.9917	Imp Perplexity: 7.3276 
2023-04-01 21:50:15,295 Epoch: 28/50	Step: [50/91]	Imp Loss: 2.4112	Imp Perplexity: 11.1475	Fin Loss: 1.8855	Imp Perplexity: 6.5896 
2023-04-01 21:51:07,124 Epoch: 29/50	Step: [0/91]	Imp Loss: 2.4863	Imp Perplexity: 12.0165	Fin Loss: 1.9413	Imp Perplexity: 6.9680 
2023-04-01 21:51:47,809 Epoch: 29/50	Step: [50/91]	Imp Loss: 2.2417	Imp Perplexity: 9.4093	Fin Loss: 1.8568	Imp Perplexity: 6.4032 
2023-04-01 21:52:39,431 Epoch: 30/50	Step: [0/91]	Imp Loss: 2.2028	Imp Perplexity: 9.0503	Fin Loss: 2.0955	Imp Perplexity: 8.1296 
2023-04-01 21:53:20,164 Epoch: 30/50	Step: [50/91]	Imp Loss: 2.2146	Imp Perplexity: 9.1577	Fin Loss: 1.9306	Imp Perplexity: 6.8940 
2023-04-01 21:54:14,543 Epoch: 31/50	Step: [0/91]	Imp Loss: 2.3263	Imp Perplexity: 10.2397	Fin Loss: 2.0723	Imp Perplexity: 7.9434 
2023-04-01 21:54:54,992 Epoch: 31/50	Step: [50/91]	Imp Loss: 2.3933	Imp Perplexity: 10.9493	Fin Loss: 1.9788	Imp Perplexity: 7.2340 
2023-04-01 21:55:46,821 Epoch: 32/50	Step: [0/91]	Imp Loss: 2.2702	Imp Perplexity: 9.6813	Fin Loss: 1.8625	Imp Perplexity: 6.4400 
2023-04-01 21:56:26,964 Epoch: 32/50	Step: [50/91]	Imp Loss: 2.2781	Imp Perplexity: 9.7584	Fin Loss: 1.8796	Imp Perplexity: 6.5508 
2023-04-01 21:57:20,951 Epoch: 33/50	Step: [0/91]	Imp Loss: 2.0529	Imp Perplexity: 7.7905	Fin Loss: 2.0875	Imp Perplexity: 8.0644 
2023-04-01 21:58:02,042 Epoch: 33/50	Step: [50/91]	Imp Loss: 2.4552	Imp Perplexity: 11.6484	Fin Loss: 2.0119	Imp Perplexity: 7.4774 
2023-04-01 21:58:53,645 Epoch: 34/50	Step: [0/91]	Imp Loss: 1.9135	Imp Perplexity: 6.7765	Fin Loss: 1.7447	Imp Perplexity: 5.7244 
2023-04-01 21:59:34,099 Epoch: 34/50	Step: [50/91]	Imp Loss: 1.9576	Imp Perplexity: 7.0824	Fin Loss: 1.8491	Imp Perplexity: 6.3540 
2023-04-01 22:00:25,739 Epoch: 35/50	Step: [0/91]	Imp Loss: 1.9582	Imp Perplexity: 7.0863	Fin Loss: 1.8250	Imp Perplexity: 6.2025 
2023-04-01 22:01:06,532 Epoch: 35/50	Step: [50/91]	Imp Loss: 2.0646	Imp Perplexity: 7.8820	Fin Loss: 1.8679	Imp Perplexity: 6.4747 
2023-04-01 22:01:58,633 Epoch: 36/50	Step: [0/91]	Imp Loss: 2.2390	Imp Perplexity: 9.3842	Fin Loss: 2.0081	Imp Perplexity: 7.4488 
2023-04-01 22:02:39,323 Epoch: 36/50	Step: [50/91]	Imp Loss: 2.0626	Imp Perplexity: 7.8665	Fin Loss: 1.9706	Imp Perplexity: 7.1751 
2023-04-01 22:03:31,158 Epoch: 37/50	Step: [0/91]	Imp Loss: 2.1771	Imp Perplexity: 8.8204	Fin Loss: 1.8561	Imp Perplexity: 6.3991 
2023-04-01 22:04:11,735 Epoch: 37/50	Step: [50/91]	Imp Loss: 1.8873	Imp Perplexity: 6.6014	Fin Loss: 1.7634	Imp Perplexity: 5.8325 
2023-04-01 22:05:03,893 Epoch: 38/50	Step: [0/91]	Imp Loss: 2.2059	Imp Perplexity: 9.0784	Fin Loss: 1.9731	Imp Perplexity: 7.1932 
2023-04-01 22:05:45,217 Epoch: 38/50	Step: [50/91]	Imp Loss: 2.3140	Imp Perplexity: 10.1147	Fin Loss: 1.8116	Imp Perplexity: 6.1204 
2023-04-01 22:06:38,000 Epoch: 39/50	Step: [0/91]	Imp Loss: 2.5125	Imp Perplexity: 12.3356	Fin Loss: 2.0272	Imp Perplexity: 7.5929 
2023-04-01 22:07:19,822 Epoch: 39/50	Step: [50/91]	Imp Loss: 2.2966	Imp Perplexity: 9.9404	Fin Loss: 1.9404	Imp Perplexity: 6.9617 
2023-04-01 22:08:13,486 Epoch: 40/50	Step: [0/91]	Imp Loss: 2.0015	Imp Perplexity: 7.4002	Fin Loss: 2.1042	Imp Perplexity: 8.2002 
2023-04-01 22:08:56,602 Epoch: 40/50	Step: [50/91]	Imp Loss: 2.1245	Imp Perplexity: 8.3691	Fin Loss: 1.8468	Imp Perplexity: 6.3394 
2023-04-01 22:09:50,597 Epoch: 41/50	Step: [0/91]	Imp Loss: 2.1240	Imp Perplexity: 8.3647	Fin Loss: 1.8643	Imp Perplexity: 6.4515 
2023-04-01 22:10:32,428 Epoch: 41/50	Step: [50/91]	Imp Loss: 2.2585	Imp Perplexity: 9.5689	Fin Loss: 1.8930	Imp Perplexity: 6.6394 
2023-04-01 22:11:25,111 Epoch: 42/50	Step: [0/91]	Imp Loss: 2.1663	Imp Perplexity: 8.7257	Fin Loss: 1.9145	Imp Perplexity: 6.7833 
2023-04-01 22:12:07,398 Epoch: 42/50	Step: [50/91]	Imp Loss: 2.0748	Imp Perplexity: 7.9627	Fin Loss: 1.9456	Imp Perplexity: 6.9981 
2023-04-01 22:13:00,582 Epoch: 43/50	Step: [0/91]	Imp Loss: 2.3254	Imp Perplexity: 10.2310	Fin Loss: 1.9516	Imp Perplexity: 7.0399 
2023-04-01 22:13:42,112 Epoch: 43/50	Step: [50/91]	Imp Loss: 2.1423	Imp Perplexity: 8.5194	Fin Loss: 1.8298	Imp Perplexity: 6.2329 
2023-04-01 22:14:34,869 Epoch: 44/50	Step: [0/91]	Imp Loss: 2.1358	Imp Perplexity: 8.4639	Fin Loss: 1.7331	Imp Perplexity: 5.6584 
2023-04-01 22:15:16,454 Epoch: 44/50	Step: [50/91]	Imp Loss: 2.1415	Imp Perplexity: 8.5125	Fin Loss: 1.8572	Imp Perplexity: 6.4060 
2023-04-01 22:16:09,188 Epoch: 45/50	Step: [0/91]	Imp Loss: 2.3444	Imp Perplexity: 10.4267	Fin Loss: 1.8390	Imp Perplexity: 6.2903 
2023-04-01 22:16:51,440 Epoch: 45/50	Step: [50/91]	Imp Loss: 2.1402	Imp Perplexity: 8.5012	Fin Loss: 1.8379	Imp Perplexity: 6.2831 
2023-04-01 22:17:46,052 Epoch: 46/50	Step: [0/91]	Imp Loss: 2.0508	Imp Perplexity: 7.7739	Fin Loss: 1.8092	Imp Perplexity: 6.1056 
2023-04-01 22:18:29,366 Epoch: 46/50	Step: [50/91]	Imp Loss: 2.1773	Imp Perplexity: 8.8226	Fin Loss: 1.8542	Imp Perplexity: 6.3865 
2023-04-01 22:19:23,188 Epoch: 47/50	Step: [0/91]	Imp Loss: 2.0767	Imp Perplexity: 7.9779	Fin Loss: 1.8178	Imp Perplexity: 6.1585 
2023-04-01 22:20:04,319 Epoch: 47/50	Step: [50/91]	Imp Loss: 2.0312	Imp Perplexity: 7.6230	Fin Loss: 1.7111	Imp Perplexity: 5.5349 
2023-04-01 22:20:57,286 Epoch: 48/50	Step: [0/91]	Imp Loss: 2.2372	Imp Perplexity: 9.3673	Fin Loss: 1.8655	Imp Perplexity: 6.4590 
2023-04-01 22:21:39,765 Epoch: 48/50	Step: [50/91]	Imp Loss: 2.0029	Imp Perplexity: 7.4106	Fin Loss: 1.8334	Imp Perplexity: 6.2548 
2023-04-01 22:22:32,771 Epoch: 49/50	Step: [0/91]	Imp Loss: 2.1984	Imp Perplexity: 9.0105	Fin Loss: 1.7999	Imp Perplexity: 6.0492 
2023-04-01 22:23:14,157 Epoch: 49/50	Step: [50/91]	Imp Loss: 1.7752	Imp Perplexity: 5.9016	Fin Loss: 1.9272	Imp Perplexity: 6.8699 
2023-04-01 22:24:13,877 Epoch: 50/50	Step: [0/91]	Imp Loss: 2.1486	Imp Perplexity: 8.5731	Fin Loss: 1.7421	Imp Perplexity: 5.7094 
2023-04-01 22:24:55,525 Epoch: 50/50	Step: [50/91]	Imp Loss: 1.9274	Imp Perplexity: 6.8714	Fin Loss: 1.7590	Imp Perplexity: 5.8067 
2023-04-01 22:25:47,725 Values of metric for the best model are: 
 BLEU:[0.4434, 0.3114, 0.2282, 0.1703], METEOR:0.1863, ROUGE:0.3671, Cider:0.2108
2023-04-01 22:25:47,725 Save the best model weights when epoch [15/50], BLEU4:0.1703
2023-04-01 22:25:47,725 =======================================================
2023-04-01 22:25:47,739 *******************************************************
2023-04-01 22:25:47,747 Final Result -- Average values of metric for the best model are: 
 BLEU:[0.41466667 0.29826667 0.2191     0.1631    ], METEOR:0.18713333333333335, ROUGE:0.3528, Cider:0.18333333333333335
